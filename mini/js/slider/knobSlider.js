var __decorate=this&&this.__decorate||function(t,e,i,o){var s,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var n=t.length-1;n>=0;n--)(s=t[n])&&(r=(a<3?s(r):a>3?s(e,i,r):s(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};import*as decorator from"../decorator.js";let KnobSlider=class{constructor(t,e,i){this.isRotating=!1,this.lastTap=0,this.rotateKnob=t=>{if("touchmove"===t.type&&t.preventDefault(),!this.isRotating)return;const e=this.knob.getBoundingClientRect(),i=e.left+this.knob.clientWidth/2,o=e.top+this.knob.clientHeight/2;let s,a;if(t instanceof TouchEvent&&t.touches.length>0)s=t.touches[0].clientX,a=t.touches[0].clientY;else{if(!(t instanceof MouseEvent))return;s=t.clientX,a=t.clientY}const r=s-i,n=a-o,c=(180*Math.atan2(n,r)/Math.PI-135+360)%360;if(c<=270){const t=c/270;this.pointer.style.transform=`rotate(${c-135}deg)`,this.circle.style.strokeDashoffset=""+(817-613*t),this.value.innerHTML=`${Math.round(t*this.maxValue)}`,this.exactValue.value=(t*this.maxValue).toString()}else c>353?(this.circle.style.strokeDashoffset="817",this.value.innerHTML="0",this.exactValue.value="0",this.pointer.style.transform="rotate(-135deg)"):c>270&&c<277&&(this.circle.style.strokeDashoffset="204",this.value.innerHTML=`${this.maxValue}`,this.exactValue.value=this.maxValue.toString(),this.pointer.style.transform="rotate(135deg)")},this.slider=t,this.knob=t.querySelector(".knob"),this.rotator=t.querySelector(".rotator"),this.pointer=t.querySelector(".pointer-frame"),this.value=t.querySelector(".value"),this.circle=t.querySelector(".circle"),this.exactValue=t.querySelector(".exact-value"),this.defaultValue=e,this.maxValue=i,this.initListeners(),this.resetKnob()}resetKnob(){this.isRotating=!1,this.pointer.style.transform="rotate(0deg)",this.circle.style.strokeDashoffset="510",this.value.innerHTML=`${this.defaultValue}`,this.exactValue.value=this.defaultValue.toString()}initListeners(){if("ontouchstart"in window||navigator.maxTouchPoints>0){const t=t=>{t.preventDefault();const e=(new Date).getTime(),i=e-this.lastTap;i<300&&i>0&&this.resetKnob(),this.lastTap=e};this.slider.addEventListener("touchstart",(()=>this.isRotating=!0)),document.addEventListener("touchmove",this.rotateKnob,{passive:!1}),document.addEventListener("touchend",(()=>this.isRotating=!1)),this.rotator.addEventListener("touchstart",t,{passive:!1})}else this.slider.addEventListener("mousedown",(()=>this.isRotating=!0)),document.addEventListener("mousemove",this.rotateKnob),document.addEventListener("mouseup",(()=>this.isRotating=!1)),this.rotator.addEventListener("dblclick",(()=>this.resetKnob()))}};__decorate([decorator.CatchErrors,decorator.Throttle(1e3),decorator.MeasureExecutionTime,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],KnobSlider.prototype,"resetKnob",null),__decorate([decorator.CatchErrors,decorator.MeasureExecutionTime,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],KnobSlider.prototype,"initListeners",null),KnobSlider=__decorate([decorator.LogClassCreation,decorator.MeasureConstructionTime,__metadata("design:paramtypes",[HTMLElement,Number,Number])],KnobSlider);export{KnobSlider};